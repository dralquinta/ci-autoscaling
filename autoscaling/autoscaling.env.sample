# OCI Container Instances Autoscaling Configuration
# Source this file before running setup-autoscaling.sh

# OCI Configuration (reuse from deploy.env)
export COMPARTMENT_OCID="ocid1.compartment.oc1..aaaaaaaxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx"
export SUBNET_OCID="ocid1.subnet.oc1.region.aaaaaaaxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx"
export AD_NAME="XXXX:REGION-AD-1"

# Container Configuration
export IMAGE_URI="docker.io/username/image:latest"
export CONTAINER_NAME="autoscaling-demo"
export DISPLAY_NAME_PREFIX="autoscaling-demo-instance"
export MEMORY_GB="8"
export OCPUS="1"
export APP_PORT="8080"
export HEALTH_CHECK_PATH="/actuator/health"

# Load Balancer Configuration
export LB_OCID="ocid1.loadbalancer.oc1.region.aaaaaaaxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx"
export BACKEND_SET_NAME="autoscaling-demo-backend-set"

# Autoscaling Limits
export MIN_INSTANCES="1"
export MAX_INSTANCES="5"

# Autoscaling Thresholds
export CPU_SCALE_UP_THRESHOLD="60"      # Percentage
export CPU_SCALE_DOWN_THRESHOLD="40"    # Percentage
export MEMORY_SCALE_UP_THRESHOLD="60"   # Percentage
export MEMORY_SCALE_DOWN_THRESHOLD="40" # Percentage

# Alarm Configuration
export ALARM_EVALUATION_PERIOD="5"      # Minutes
export ALARM_FREQUENCY="1"              # Minutes (check interval)

# Functions Configuration
export FUNCTIONS_APP_NAME="ci-autoscaling-app"
export SCALE_UP_FUNCTION_NAME="scale-up"
export SCALE_DOWN_FUNCTION_NAME="scale-down"

# VCN/Subnet for Functions (should be same or different subnet in same VCN)
export FUNCTIONS_SUBNET_OCID="$SUBNET_OCID"

# Notification Topic
export NOTIFICATION_TOPIC_NAME="ci-autoscaling-notifications"
export NOTIFICATION_EMAIL=""  # Optional: Set to receive email notifications

# Resource Tags (optional)
export RESOURCE_TAG_NAMESPACE="autoscaling"
export RESOURCE_TAG_KEY="managed-by"
export RESOURCE_TAG_VALUE="ci-autoscaling"
